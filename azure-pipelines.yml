# Nome da pipeline
name: MinhaPipeline

# Pool de agentes (assumindo ambiente Ubuntu)
pool:
  vmImage: ubuntu-latest

# Gatilho: executa a pipeline em push para a branch 'main' e pull requests
trigger:
  branches:
    include:
      - main
pr:
    branches:
      include:
        - main

stages:
- stage: ConfigurandoProjeto
  jobs:
    - job: CopiarArquivosDoProjeto
      steps:
        - checkout: self
# Instalar Python
    - job: InstalarPython
      steps:
        - task: UsePythonVersion@0  
          inputs:
            versionSpec: '3.11'
            architecture: 'x64' 
# Instalar Poetry
    - job: InstalarPoetry
      dependsOn: InstalarPython
      steps: 
        - script: curl -sSL https://install.python-poetry.org | python3 -
# Inicializar Poetry
    - job: InicializarPoetry
      dependsOn: InstalarPoetry 
      steps:
        - script: poetry init
# Instalar DependÃªncias
    - job: InstalarDependenciasPoetry
      dependsOn: InicializarPoetry 
      steps:
        - script: poetry install
# Executar testes 
    - job: ExecutarTestes
      dependsOn: InstalarDependenciasPoetry  
      steps:
        - script: poetry run task test  
