name: Pipeline

# Pool de agentes que será usado para a execução do pipeline
pool:
  vmImage: ubuntu-latest

# Equivalente ao -> on : [push, pull_request]
trigger:
  branches:
    include:
      - main
pr:
  branches:
    include:
      - main

# Instalar Python
stages:
  - stage: InstallPythonAndDependencies
    jobs:
      - job: PythonVersion
        steps:
        - task: UsePythonVersion@0
          inputs:
            versionSpec: '3.11'
            disableDownloadFromRegistry: true
            addToPath: true
            architecture: 'x64'
      - job: InstallPoetry
        steps:
          - script: conda install -c conda-forge python=3.11.^
      - job: InstallDependencies
        steps:
          - script: poetry install
      - job: ExecTests
        steps:
          - script: poetry run task test


